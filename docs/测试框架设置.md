# æµ‹è¯•æ¡†æ¶è®¾ç½®æŒ‡å—

æœ¬é¡¹ç›®å·²é…ç½®å®Œæ•´çš„ Jest + React Testing Library æµ‹è¯•æ¡†æ¶ã€‚

## ğŸ§ª å·²é…ç½®å†…å®¹

### æµ‹è¯•æ¡†æ¶

- **Jest**: JavaScript æµ‹è¯•æ¡†æ¶ï¼Œä¸ Next.js å®Œå…¨é›†æˆ
- **React Testing Library**: React ç»„ä»¶æµ‹è¯•åº“
- **Jest DOM**: é¢å¤–çš„ DOM åŒ¹é…å™¨
- **JSDOM**: æµè§ˆå™¨ç¯å¢ƒæ¨¡æ‹Ÿ

### é…ç½®æ–‡ä»¶

- `jest.config.js`: Jest ä¸»é…ç½®æ–‡ä»¶
- `jest.setup.js`: Jest è®¾ç½®æ–‡ä»¶
- `__tests__/utils/test-utils.js`: æµ‹è¯•å·¥å…·åº“

## ğŸ“¦ æµ‹è¯•ä¾èµ–

å·²åœ¨ `package.json` ä¸­æ·»åŠ ä»¥ä¸‹å¼€å‘ä¾èµ–ï¼š

```json
{
  "devDependencies": {
    "@testing-library/jest-dom": "^6.1.6",
    "@testing-library/react": "^14.1.2",
    "@testing-library/user-event": "^14.5.1",
    "jest": "^29.7.0",
    "jest-environment-jsdom": "^29.7.0"
  }
}
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å®‰è£…ä¾èµ–

```bash
npm install --legacy-peer-deps
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘è§†æ¨¡å¼è¿è¡Œæµ‹è¯•
npm run test:watch

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

### éªŒè¯è®¾ç½®

```bash
node scripts/test-setup-verification.js
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
blog/
â”œâ”€â”€ __tests__/
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ test-utils.js          # æµ‹è¯•å·¥å…·åº“
â”‚   â””â”€â”€ example.test.js            # ç¤ºä¾‹æµ‹è¯•
â”œâ”€â”€ components/
â”‚   â””â”€â”€ __tests__/
â”‚       â”œâ”€â”€ Card.test.js           # Card ç»„ä»¶æµ‹è¯•
â”‚       â”œâ”€â”€ Tag.test.js            # Tag ç»„ä»¶æµ‹è¯•
â”‚       â””â”€â”€ PageTitle.test.js      # PageTitle ç»„ä»¶æµ‹è¯•
â”œâ”€â”€ jest.config.js                 # Jest é…ç½®
â”œâ”€â”€ jest.setup.js                  # Jest è®¾ç½®
â””â”€â”€ scripts/
    â””â”€â”€ test-setup-verification.js # è®¾ç½®éªŒè¯è„šæœ¬
```

## ğŸ§ª æµ‹è¯•ç¤ºä¾‹

### ç»„ä»¶æµ‹è¯•

```javascript
import { render, screen } from '../__tests__/utils/test-utils'
import MyComponent from '../MyComponent'

test('renders component correctly', () => {
  render(<MyComponent />)
  expect(screen.getByText('Hello World')).toBeInTheDocument()
})
```

### ä½¿ç”¨æµ‹è¯•å·¥å…·

```javascript
import { render, screen } from '../__tests__/utils/test-utils'
// è‡ªåŠ¨åŒ…å« Next.js ä¸»é¢˜æä¾›è€…å’Œå…¶ä»–å¿…è¦çš„æä¾›è€…
```

## ğŸ“Š è¦†ç›–ç‡é…ç½®

- **ç›®æ ‡ç›®å½•**: `components/`, `lib/`, `layouts/`
- **æ’é™¤æ–‡ä»¶**: `.d.ts`, `node_modules`
- **æŠ¥å‘Šæ ¼å¼**: text, lcov, html
- **è¾“å‡ºç›®å½•**: `coverage/`

## ğŸ”§ Mock é…ç½®

### Next.js è·¯ç”±

```javascript
import { mockRouter } from '../__tests__/utils/test-utils'
```

### Next.js å›¾ç‰‡

```javascript
import { mockImage } from '../__tests__/utils/test-utils'
```

## ğŸ“‹ å·²æµ‹è¯•ç»„ä»¶

| ç»„ä»¶      | æµ‹è¯•æ•°é‡ | è¦†ç›–å†…å®¹                   |
| --------- | -------- | -------------------------- |
| Card      | 9        | æ¸²æŸ“ã€å›¾ç‰‡ã€é“¾æ¥ã€å¯è®¿é—®æ€§ |
| Tag       | 6        | æ¸²æŸ“ã€é“¾æ¥ç”Ÿæˆã€CSS ç±»å   |
| PageTitle | 5        | æ¸²æŸ“ã€å­å†…å®¹ã€CSS ç±»å     |

## ğŸ¯ æœ€ä½³å®è·µ

1. **ç»„ä»¶æµ‹è¯•**: ä½¿ç”¨ `@testing-library/react` æµ‹è¯•ç»„ä»¶è¡Œä¸º
2. **Mock**: é€‚å½“æ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ–ï¼ˆAPI è°ƒç”¨ã€è·¯ç”±ç­‰ï¼‰
3. **å¯è®¿é—®æ€§**: åŒ…å«å¯è®¿é—®æ€§æµ‹è¯•
4. **è¦†ç›–ç‡**: ä¿æŒ 80% ä»¥ä¸Šçš„ä»£ç è¦†ç›–ç‡
5. **æè¿°æ€§**: ä½¿ç”¨æ¸…æ™°çš„æµ‹è¯•æè¿°

## ğŸ› æ•…éšœæ’é™¤

### ä¾èµ–å†²çª

å¦‚æœé‡åˆ° React 19 ä¸ Testing Library çš„ä¾èµ–å†²çªï¼š

```bash
npm install --legacy-peer-deps
```

### æƒé™é—®é¢˜

å¦‚æœé‡åˆ° npm ç¼“å­˜æƒé™é—®é¢˜ï¼š

```bash
sudo chown -R $(whoami) ~/.npm
```

### TypeScript é”™è¯¯

ç¡®ä¿æµ‹è¯•æ–‡ä»¶ä½¿ç”¨ `.test.js` æˆ– `.test.tsx` æ‰©å±•åï¼Œå¹¶åœ¨ `tsconfig.json` ä¸­åŒ…å«æµ‹è¯•æ–‡ä»¶ã€‚

## ğŸ“š å­¦ä¹ èµ„æº

- [Jest æ–‡æ¡£](https://jestjs.io/docs/getting-started)
- [React Testing Library æ–‡æ¡£](https://testing-library.com/docs/react-testing-library/intro/)
- [Next.js æµ‹è¯•æŒ‡å—](https://nextjs.org/docs/testing)

---

_é…ç½®å®Œæˆæ—¶é—´: 2025-12-06_
_æµ‹è¯•ç”¨ä¾‹æ€»æ•°: 20+_
_è¦†ç›–ç‡ç›®æ ‡: 80%+_
